# bilimiao 精简版修改指南 (完整版)

## 目标
将 bilimiao 应用精简为只保留以下核心功能：
- ✅ 视频搜索
- ✅ 视频下载
- ✅ 视频播放

需要移除的功能：
- ❌ 主页（推荐、热门）
- ❌ 时光机
- ❌ 收藏
- ❌ 追番/追剧
- ❌ 历史记录
- ❌ 稍后看

---

## 修改步骤

### 1. 精简启动页面的库功能卡片

**文件**: `bilimiao-compose/src/main/java/cn/a10miaomiao/bilimiao/compose/components/start/StartLibraryCard.kt`

**修改内容**:
将整个 `StartLibraryCard` 函数体替换为空实现：

```kotlin
@Composable
fun StartLibraryCard(
    userId: Long?,
    navigateTo: (ComposePage) -> Unit,
) {
    // 精简版：移除所有库功能（收藏、追番、历史、稍后看）
    // 仅保留搜索、下载和播放功能
}
```

同时删除不再需要的导入语句和 `LibraryItemCard` 组件定义。

---

### 2. 禁用不需要的路由

**文件**: `bilimiao-compose/src/main/java/cn/a10miaomiao/bilimiao/compose/BilimiaoPageRoute.kt`

**修改内容**:
注释掉以下页面的路由注册：
- `HomePage` (主页)
- `TimeSettingPage`, `TimeRegionDetailPage` (时光机)
- `MyBangumiPage`, `MyFollowPage`, `HistoryPage`, `WatchLaterPage` (我的库)

---

### 3. 替换应用入口点

**文件**: `bilimiao-compose/src/main/java/cn/a10miaomiao/bilimiao/compose/ComposeFragment.kt`

**修改内容**:
由于移除了 `HomePage`，需要将应用的起始页面替换为 `BlankPage`（或其他存在的页面）。

1.  修改导入：
    ```kotlin
    // 删除 import cn.a10miaomiao.bilimiao.compose.pages.home.HomePage
    import cn.a10miaomiao.bilimiao.compose.pages.BlankPage
    ```

2.  修改 `MyNavHost` 调用：
    ```kotlin
    // MyNavHost(composeNav, HomePage)
    MyNavHost(composeNav, BlankPage)
    ```

3.  修改 `goBackHome` 方法：
    ```kotlin
    // composeNav.popBackStack(HomePage, false)
    composeNav.popBackStack(BlankPage, false)
    ```

---

### 4. 处理其他文件中的引用

为了防止编译错误，需要处理其他文件中对 `HomePage` 的引用：

- **`DynamicViewModel.kt`**: 将跳转到 `HomePage` 的逻辑改为跳转到 `BlankPage`。
- **`DynamicPage.kt`**: 移除未使用的 `HomePage` 导入。
- **`TelVerifyPage.kt`**: 移除未使用的 `HomePage` 导入。
- **`QrCodeLoginPage.kt`**: 移除未使用的 `HomePage` 导入。

---

## 编译和测试

### 环境要求
- JDK 17 (Android Gradle Plugin 8.0+ 要求)
- Android SDK 35

### 编译命令

```bash
cd d:\Downloads\BLVD
.\gradlew assembleDebug
```

### 生成的 APK 位置

```
app/build/outputs/apk/debug/app-debug.apk
```

---

## 预期效果

修改完成后，应用启动页面将只显示：
1. **用户信息卡片** - 登录状态、关注数等
2. **搜索卡片** - 视频搜索功能
3. **底部功能** - 视频下载、设置

不再显示：
- 收藏卡片
- 追番/追剧卡片
- 历史记录卡片
- 稍后看卡片
- 主页入口（推荐、时光机）

---

## 自动化脚本

已提供以下脚本来辅助修改：
- `modify_routes.py`: 修改路由文件
- `modify_compose_fragment.py`: 修改入口文件
- `modify_others.py`: 修改其他引用文件

运行方法：
```bash
python modify_routes.py
python modify_compose_fragment.py
python modify_others.py
```
